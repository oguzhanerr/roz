---
title: "Roz Tutorial Part I"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Roz Tutorial Part I}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r check-title, echo=FALSE}
options(rmarkdown.html_vignette.check_title = FALSE) 
```

# Introduction

This vignette demonstrates how to use the `roz` package to read and validate example CSV files.

## Step 1: Show the list of example files

First, we list the example files available in the package:

```{r list-example-files, echo=TRUE}
library(roz)
example_files <- read_example()
print(example_files)
```

## Step 2: Read the raw_data.csv and transform into df

Next, we read the `raw_data.csv` file:

```{r read-raw-data, echo=TRUE}
file_path <- read_example("raw_data.csv")
df <- readr::read_csv(file_path)
head(df)
```

## Step 3: Explore the example data

Now, let's inspect the first few rows of the example "ben_poi_data.csv" data:

```{r check-head, echo=TRUE}
ben_file_path <- read_example("ben_poi_data.csv")
ben_poi_df <- readr::read_csv(ben_file_path)
head(ben_poi_df)
```

## Step 4: Check Approximate Column Names and Modify

Now, let's check and rename approximate column names to match the expected column names:

```{r approximate-column-names, echo=TRUE}
ben_poi_df_renamed <- check_approximate_column_names(ben_poi_df)
head(ben_poi_df_renamed)
```
Looks like is_connected and has_electricity columns are "double" data types. So we want to transform them into "logical".

## Step 4: Check Approximate Data Types and Modify

```{r modified-data-types, echo=TRUE}
ben_poi_df_modified <- modify_data_types(ben_poi_df_renamed)
head(ben_poi_df_modified)
```


## Step 5: Validate Columns and Data Types

Now, we validate the dataframe columns and data types:

```{r transform-data-frame, echo=TRUE}
validate_data_types(ben_poi_df_modified)
```

## Step 6: Transform all character data to lower case

Let's transform all character data in the data frame to lower case:

```{r transform-lower, echo=TRUE, error=TRUE}
df <- transform_to_lower_case(ben_poi_df_modified)
head(df)
```

## Step 7: Export the final data frame

Export the final data frame to a CSV file: To use it delete the "#" comment sign at the beginning and update the default path to desired one.

```{r export, echo=TRUE, error=TRUE}
 #### export_final_df(df, "path/to/final_df.csv")  # Update this to the desired export path
```

## Step 8: Demonstrate to transform invalid_raw_data.csv to df

Finally, let's demonstrate the transformation of `invalid_raw_data.csv` which contains invalid data types. This should fail the validation:

```{r transform-invalid-data, echo=TRUE, error=TRUE}
invalid_file_path <- read_example("invalid_raw_data.csv")
df_invalid <- readr::read_csv(ben_file_path)
validate_data_types(df_invalid)
```

This will demonstrate the error messages generated by the validation functions when the data does not meet the expected schema.

# Conclusion

In this vignette, we demonstrated how to list example files, read and validate a CSV file, check and modify approximate column names, transform data, handle invalid data, transform all character data to lower case, and export the final data frame using the "roz" package.
